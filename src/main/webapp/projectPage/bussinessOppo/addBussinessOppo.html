<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>富文本编辑器</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../lib/layui-v2.5.5/css/layui.css" media="all">
    <link rel="stylesheet" href="../../lib/font-awesome-4.7.0/css/font-awesome.min.css" media="all">
    <link rel="stylesheet" href="../../css/public.css" media="all">
    <script src="../../lib/layui-v2.5.5/layui.js" charset="utf-8"></script>
</head>
<body>
<button class="layui-btn layui-btn-sm data-add-btn" id="but"> 返回 </button>
<div id="add-user-layer" style="display: block; padding: 20px">
    <form class="layui-form" action="" method="post" id="add-user-form">
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机名称:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bname" lay-verify="required|bname" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">优先级:</label>
                <div class="layui-input-block">
                    <input type="radio" name="priority" value="1" title="1" checked="">
                    <input type="radio" name="priority" value="2" title="2">
                    <input type="radio" name="priority" value="3" title="3">
                </div>
            </div>
        </div>
        <div id="u636" class="ax_default box_1">
            <div id="u636_div" class=""></div>
            <div id="u636_text" class="text ">
                <p><span>客户信息</span></p>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">客户名称:</label>
                <div class="layui-input-inline">
                    <input type="text" name="cname" lay-verify="required|cname" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">所属行业:</label>
                <div class="layui-input-inline">
                    <select name="cindustry">
                        <option value="1" selected>请选择</option>
                        <option value="2">IT|互联网|通信|电子</option>
                        <option value="3">金融|银行|保险</option>
                        <option value="4">房产|建筑建设|物业</option>
                        <option value="5">广告|传媒|印刷出版</option>
                        <option value="6">消费零售|贸易|交通物流</option>
                        <option value="7">加工制造|仪表设备</option>
                        <option value="8">管理咨询|教育科研|中介服务</option>
                        <option value="9">医药生物|医疗保健</option>
                        <option value="10">酒店旅游</option>
                        <option value="11">能源矿产|石油化工</option>
                        <option value="12">政府|非赢利机构|科研</option>
                        <option value="13">其他</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">所在城市:</label>
                <div class="layui-input-inline">
                    <input type="text" name="ccity" lay-verify="required|ccity" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">详细地址:</label>
                <div class="layui-input-block">
                    <input type="text" name="caddress" lay-verify="required|caddress" autocomplete="off" placeholder="请输入详细地址" class="layui-input">
                </div>
            </div>
        </div>

        <div id="u635" class="ax_default box_1">
            <div id="u635_div" class=""></div>
            <div id="u635_text" class="text ">
                <p><span>商机信息</span></p>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机名称:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bname" lay-verify="required|bname" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">客户来源:</label>
                <div class="layui-input-inline">
                    <select name="csource" lay-verify="required" lay-search="">
                        <option value="1">直接选择或搜索选择</option>
                        <option value="2">老客户</option>
                        <option value="3">代理商</option>
                        <option value="4">互联网</option>
                        <option value="5">独立开发</option>
                        <option value="6">客户介绍</option>
                        <option value="7">合作伙伴</option>
                        <option value="8">促销活动</option>
                        <option value="9">媒体宣传</option>
                        <option value="10">电话访问</option>
                        <option value="11">客户来电</option>
                        <option value="12">二次销售</option>
                        <option value="13">公开招标</option>
                        <option value="14">研讨会和展会</option>
                        <option value="15">其他</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">预计成交金额:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bpredictMoney" lay-verify="required|bpredictMoney" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">预计结单日期:</label>
                <div class="layui-input-inline">
                    <input type="text" name="boverDate" id="date" lay-verify="date" placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">联系人:</label>
                <div class="layui-input-inline">
                    <input type="text" name="blinkman" lay-verify="required|blinkman" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">部门:</label>
                <div class="layui-input-block">
                    <input type="text" name="bdept" lay-verify="required|bdept" autocomplete="off" placeholder="请输入" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">职务:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bjob" lay-verify="required|bjob" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">固定电话:</label>
                <div class="layui-input-block">
                    <input type="text" name="bofficeno" lay-verify="required|bofficeno" autocomplete="off" placeholder="请输入" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">移动电话:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bphoneno" lay-verify="required|bphoneno" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">邮箱:</label>
                <div class="layui-input-block">
                    <input type="text" name="bemail" lay-verify="required|bemail" autocomplete="off" placeholder="请输入详细地址" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">主要业务需求:</label>
            <div class="layui-input-block">
                <textarea placeholder="请输入内容" class="layui-textarea" name="bneed"></textarea>
            </div>
        </div>
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
            <legend>指定允许上传的文件类型</legend>
        </fieldset>

        <button type="button" class="layui-btn" id="test3" name="bfile"><i class="layui-icon"></i>上传文件</button>
        <input type="hidden" name="bfile" id="hi"/>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机所属部门:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bofDept" lay-verify="required|bofDept" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">商机负责人:</label>
                <div class="layui-input-block">
                    <input type="text" name="bprincipal" lay-verify="required|bprincipal" autocomplete="off" placeholder="请输入" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机参与人:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bjoinMan" lay-verify="required|bjoinMan" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">商机关注人:</label>
                <div class="layui-input-block">
                    <input type="text" name="battention" lay-verify="required|battention" autocomplete="off" placeholder="请输入" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-form-item"  style="text-align: center">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="add-submit">立即提交</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>

    </form>
</div>

<script>
    layui.use(['form', 'layedit', 'laydate','upload'], function(){
        var form = layui.form
        var $ = layui.jquery
            ,layer = layui.layer
            ,layedit = layui.layedit
            ,laydate = layui.laydate
            ,upload = layui.upload
            , $ = layui.$;
        //创建一个编辑器
        var editIndex = layedit.build('LAY_demo_editor');
        $("#but").click(function(){
            window.parent.location.reload();
        });
        // 添加用户表单提交
        form.on('submit(add-submit)', function(data) {
            // ajax方式添加用户
            $.ajax({
                url: "../../bussinessOppo/insert.do",
                type: "post",
                data: data.field,
                dataType: 'json',

                success: function(data) {
                    if (data == 0) {

                        layer.closeAll();
                        layer.msg('添加成功');
                        window.parent.location.reload();
                        table.reload('test');
                        $("#add-user-form")[0].reset();
                    } else {
                        layer.msg('添加失败');
                    }
                },

            });
            // 阻止表单跳转
            return false;
        });

        //指定允许上传的文件类型
        upload.render({
            elem: '#test3'
            ,url: '../../afterSell/uploadFile.do' //改成您自己的上传接口
            ,accept: 'file' //普通文件
            ,done: function(res){
                $("#hi").val(res.filename);
                layer.msg('上传成功');
                console.log(res);
            }
        });
        laydate.render({
            elem: '#date'
        });


    });
</script>







</body>
</html>