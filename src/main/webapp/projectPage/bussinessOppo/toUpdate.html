<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>首页二</title>
    <base th:href="${#request.getContextPath()}+'/'">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="lib/layui-v2.5.5/css/layui.css" media="all">
    <link rel="stylesheet" href="lib/font-awesome-4.7.0/css/font-awesome.min.css" media="all">
    <link rel="stylesheet" href="css/public.css" media="all">
    <script src="lib/layui-v2.5.5/layui.js" charset="utf-8"></script>
    <script src="lib/jquery-3.4.1/jquery-3.4.1.min.js"></script>
</head>
<body>
<button class="layui-btn layui-btn-sm data-add-btn" id="but">返回</button>
<div id="add-user-layer" style="display: block; padding: 20px">
    <form class="layui-form" action="" method="post" id="add-user-form">
        <input type="hidden" name="bid" th:value="${bus.bid}">
        <input type="hidden" name="cid" th:value="${cust.cid}"/>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机名称:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bname" lay-verify="required|bname" autocomplete="off" class="layui-input" th:value="${bus.bname}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">优先级:</label>
                <div class="layui-input-block">
                    <input type="radio" name="priority" value="1" title="1" th:checked="${bus.priority} == 1">
                    <input type="radio" name="priority" value="2" title="2" th:checked="${bus.priority}== 2">
                    <input type="radio" name="priority" value="3" title="3" th:checked="${bus.priority} == 3">
                </div>
            </div>
        </div>
        <div id="u636" class="ax_default box_1">
            <div id="u636_div" class=""></div>
            <div id="u636_text" class="text ">
                <p><span>客户信息</span></p>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">客户名称:</label>
                <div class="layui-input-inline">
                    <input type="text" name="cname" lay-verify="required|cname" autocomplete="off" class="layui-input" th:value="${cust.cname}">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">所属行业:</label>
                <div class="layui-input-inline">
                    <select name="cindustry">
                        <option value="1" selected>请选择</option>
                        <option value="2" th:selected="${cust.cindustry eq '2'}">IT|互联网|通信|电子</option>
                        <option value="3" th:selected="${cust.cindustry eq '3'}">金融|银行|保险</option>
                        <option value="4" th:selected="${cust.cindustry eq '4'}">房产|建筑建设|物业</option>
                        <option value="5" th:selected="${cust.cindustry eq '5'}">广告|传媒|印刷出版</option>
                        <option value="6" th:selected="${cust.cindustry eq '6'}">消费零售|贸易|交通物流</option>
                        <option value="7" th:selected="${cust.cindustry eq '7'}">加工制造|仪表设备</option>
                        <option value="8" th:selected="${cust.cindustry eq '8'}">管理咨询|教育科研|中介服务</option>
                        <option value="9" th:selected="${cust.cindustry eq '9'}">医药生物|医疗保健</option>
                        <option value="10" th:selected="${cust.cindustry eq '10'}">酒店旅游</option>
                        <option value="11" th:selected="${cust.cindustry eq '11'}">能源矿产|石油化工</option>
                        <option value="12" th:selected="${cust.cindustry eq '12'}">政府|非赢利机构|科研</option>
                        <option value="13" th:selected="${cust.cindustry eq '13'}">其他</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">所在城市:</label>
                <div class="layui-input-inline">
                    <input type="text" name="ccity" lay-verify="required|ccity" autocomplete="off" class="layui-input" th:value="${cust.ccity}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">详细地址:</label>
                <div class="layui-input-block">
                    <input type="text" name="caddress" lay-verify="required|caddress" autocomplete="off" placeholder="请输入" class="layui-input" th:value="${cust.caddress}">
                </div>
            </div>
        </div>

        <div id="u635" class="ax_default box_1">
            <div id="u635_div" class=""></div>
            <div id="u635_text" class="text ">
                <p><span>商机信息</span></p>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机名称:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bname" lay-verify="required|bname" autocomplete="off" class="layui-input"  th:value="${bus.bname}">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">客户来源:</label>
                <div class="layui-input-inline">
                    <select name="csource" lay-verify="required" lay-search="">
                        <option value="0" th:selected="${cust.csource eq 0}">直接选择或搜索选择</option>
                        <option value="1" th:selected="${cust.csource eq 1}">老客户</option>
                        <option value="2" th:selected="${cust.csource eq 2}">代理商</option>
                        <option value="3" th:selected="${cust.csource eq 3}">互联网</option>
                        <option value="4" th:selected="${cust.csource eq 4}">独立开发</option>
                        <option value="5" th:selected="${cust.csource eq 5}">客户介绍</option>
                        <option value="6" th:selected="${cust.csource eq 6}">合作伙伴</option>
                        <option value="7" th:selected="${cust.csource eq 7}">促销活动</option>
                        <option value="8" th:selected="${cust.csource eq 8}">媒体宣传</option>
                        <option value="9" th:selected="${cust.csource eq 9}">电话访问</option>
                        <option value="10" th:selected="${cust.csource eq 10}">客户来电</option>
                        <option value="11" th:selected="${cust.csource eq 11}">二次销售</option>
                        <option value="12" th:selected="${cust.csource eq 12}">公开招标</option>
                        <option value="13" th:selected="${cust.csource eq 13}">研讨会和展会</option>
                        <option value="14" th:selected="${cust.csource eq 14}">其他</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">预计成交金额:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bpredictMoney" lay-verify="required|bpredictMoney" autocomplete="off" class="layui-input"  th:value="${bus.bpredictMoney}">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">预计结单日期:</label>
                <div class="layui-input-inline">
                    <input type="text" name="boverDate" id="date" lay-verify="date" placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input"  th:value="${bus.boverDate}">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">联系人:</label>
                <div class="layui-input-inline">
                    <input type="text" name="blinkman" lay-verify="required|blinkman" autocomplete="off" class="layui-input"  th:value="${bus.blinkman}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">部门:</label>
                <div class="layui-input-block">
                    <input type="text" name="bdept" lay-verify="required|bdept" autocomplete="off" placeholder="请输入" class="layui-input"  th:value="${bus.bdept}">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">职务:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bjob" lay-verify="required|bjob" autocomplete="off" class="layui-input"  th:value="${bus.bjob}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">固定电话:</label>
                <div class="layui-input-block">
                    <input type="text" name="bofficeno" lay-verify="required|bofficeno" autocomplete="off" placeholder="请输入" class="layui-input"  th:value="${bus.bofficeno}">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">移动电话:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bphoneno" lay-verify="required|bphoneno" autocomplete="off" class="layui-input"  th:value="${bus.bphoneno}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">邮箱:</label>
                <div class="layui-input-block">
                    <input type="text" name="bemail" lay-verify="required|bemail" autocomplete="off" placeholder="请输入" class="layui-input"  th:value="${bus.bemail}">
                </div>
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">主要业务需求:</label>
            <div class="layui-input-block">
                <textarea placeholder="请输入内容" class="layui-textarea" name="bneed"  th:value="${bus.bneed}"></textarea>
            </div>
        </div>
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
            <legend>指定允许上传的文件类型</legend>
        </fieldset>

        <button type="button" class="layui-btn" id="test3" name="bfile"><i class="layui-icon"></i>上传文件</button>
        <input type="hidden" name="bfile" id="hi"/>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机所属部门:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bofDept" lay-verify="required|bofDept" autocomplete="off" class="layui-input"  th:value="${bus.bofDept}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">商机负责人:</label>
                <div class="layui-input-block">
                    <input type="text"  lay-verify="required|bprincipal" disabled="disabled" autocomplete="off" placeholder="请输入" class="layui-input"  th:value="${bus.username}">
               <input type="hidden" name="bprincipal" th:value="${bus.bprincipal}">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机参与人:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bjoinMan" lay-verify="required|bjoinMan" autocomplete="off" class="layui-input"  th:value="${bus.bjoinMan}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">商机关注人:</label>
                <div class="layui-input-block">
                    <input type="text" name="battention" lay-verify="required|battention" autocomplete="off" placeholder="请输入" class="layui-input"  th:value="${bus.battention}">
                </div>
            </div>
        </div>
        <div class="layui-form-item"  style="text-align: center">
            <div class="layui-form-item">
                <button class="layui-btn" lay-submit lay-filter="demo2">立即提交</button>
            </div>
        </div>

    </form>
</div>

<script>
    layui.use(['form','layer', 'laydate','upload'], function(){
        var form = layui.form,layer= layui.layer,upload=layui.upload  ,laydate = layui.laydate , $ = layui.$;
        $("#but").click(function(){
            window.parent.location.reload();
        });
        $("body").on("click", '.data-add-btn', function () {
            window.location.href = "projectPage/bussinessOppo/allBussinessOppo.html";
            var index = parent.layer.getFrameIndex(window.name);
            parent.layer.close(index);
        });
        form.on('submit(demo2)', function (data) {
            $.ajax({
                url: 'bussinessOppo/update.do',
                type: 'POST',
                dataType: 'json',
                data: data.field,
                success: function (msg) {
                    if (msg == 0) {
                        layer.msg("修改成功", {icon: 1, time: 1000}, function () {
                            //关闭当前页面并打开主页面
                            var index = parent.layer.getFrameIndex(window.name);
                            parent.layer.close(index);
                            parent.location.reload();
                        });
                    } else {
                        layer.msg("修改失败", {icon: 6});
                    }
                }
            });
            return false;
        });






       /* form.on('submit(demo2)', function(data){
            var da=data.field;
            $.ajax({
                type:'post',
                url:'',
                data:da,
                success:function (data) {
                    if(data == 0){
                        window.parent.location.reload();
                        var index = parent.layer.getFrameIndex(window.name);
                        parent.layer.close(index);
                    }else {
                        layer.msg("修改失败", {icon: 6});
                    }
                }
            });
           return false;
        });*/

        //指定允许上传的文件类型
        upload.render({
            elem: '#test3'
            ,url: 'afterSell/uploadFile.do' //改成您自己的上传接口
            ,accept: 'file' //普通文件
            ,done: function(res){
                $("#hi").val(res.filename);
                layer.msg('上传成功');
                console.log(res);
            }
        });
        laydate.render({
            elem: '#date'
        });
    });
</script>













</body>
</html>