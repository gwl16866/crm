<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>首页二</title>
    <base th:href="${#request.getContextPath()}+'/'">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="lib/layui-v2.5.5/css/layui.css" media="all">
    <link rel="stylesheet" href="lib/font-awesome-4.7.0/css/font-awesome.min.css" media="all">
    <link rel="stylesheet" href="css/public.css" media="all">
    <script src="lib/layui-v2.5.5/layui.js" charset="utf-8"></script>
    <script src="lib/jquery-3.4.1/jquery-3.4.1.min.js"></script>
</head>
<body>
<button class="layui-btn layui-btn-sm data-add-btn" id="but"> 返回 </button>
<div id="add-user-layer" style="display: block; padding: 20px">
    <form class="layui-form" action="" method="post" id="add-user-form">
        <input type="hidden" name="bid" th:value="${bus.bid}">
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机名称:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bname" lay-verify="required|bname" autocomplete="off" class="layui-input" th:value="${bus.bname}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">优先级:</label>
                <div class="layui-input-block">
                    <input type="radio" name="priority" value="1" title="1" checked="" th:checked="${bus.priority eq 1}">
                    <input type="radio" name="priority" value="2" title="2" th:checked="${bus.priority eq 2}">
                    <input type="radio" name="priority" value="3" title="3" th:checked="${bus.priority eq 3}">
                </div>
            </div>
        </div>
        <div id="u636" class="ax_default box_1">
            <div id="u636_div" class=""></div>
            <div id="u636_text" class="text ">
                <p><span>客户信息</span></p>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">客户名称:</label>
                <div class="layui-input-inline">
                    <input type="text" name="cname" lay-verify="required|cname" autocomplete="off" class="layui-input" th:value="${cust.cname}">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">所属行业:</label>
                <div class="layui-input-inline">
                    <select name="cindustry">
                        <option value="1" selected>请选择</option>
                        <option value="IT|互联网|通信|电子" th:selected="${cust.cindustry eq 'IT|互联网|通信|电子'}">IT|互联网|通信|电子</option>
                        <option value="金融|银行|保险" th:selected="${cust.cindustry eq '金融|银行|保险'}">金融|银行|保险</option>
                        <option value="房产|建筑建设|物业" th:selected="${cust.cindustry eq '房产|建筑建设|物业'}">房产|建筑建设|物业</option>
                        <option value="广告|传媒|印刷出版" th:selected="${cust.cindustry eq '广告|传媒|印刷出版'}">广告|传媒|印刷出版</option>
                        <option value="消费零售|贸易|交通物流" th:selected="${cust.cindustry eq '消费零售|贸易|交通物流'}">消费零售|贸易|交通物流</option>
                        <option value="加工制造|仪表设备" th:selected="${cust.cindustry eq '加工制造|仪表设备'}">加工制造|仪表设备</option>
                        <option value="管理咨询|教育科研|中介服务" th:selected="${cust.cindustry eq '管理咨询|教育科研|中介服务'}">管理咨询|教育科研|中介服务</option>
                        <option value="医药生物|医疗保健" th:selected="${cust.cindustry eq '医药生物|医疗保健'}">医药生物|医疗保健</option>
                        <option value="酒店旅游" th:selected="${cust.cindustry eq '酒店旅游'}">酒店旅游</option>
                        <option value="能源矿产|石油化工" th:selected="${cust.cindustry eq '能源矿产|石油化工'}">能源矿产|石油化工</option>
                        <option value="政府|非赢利机构|科研" th:selected="${cust.cindustry eq '政府|非赢利机构|科研'}">政府|非赢利机构|科研</option>
                        <option value="其他" th:selected="${cust.cindustry eq '其他'}">其他</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">所在城市:</label>
                <div class="layui-input-inline">
                    <input type="text" name="ccity" lay-verify="required|ccity" autocomplete="off" class="layui-input" th:value="${cust.ccity}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">详细地址:</label>
                <div class="layui-input-block">
                    <input type="text" name="caddress" lay-verify="required|caddress" autocomplete="off" placeholder="请输入详细地址" class="layui-input" th:value="${cust.caddress}">
                </div>
            </div>
        </div>

        <div id="u635" class="ax_default box_1">
            <div id="u635_div" class=""></div>
            <div id="u635_text" class="text ">
                <p><span>商机信息</span></p>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机名称:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bname" lay-verify="required|bname" autocomplete="off" class="layui-input"  th:value="${bus.bname}">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">客户来源:</label>
                <div class="layui-input-inline">
                    <select name="csource" lay-verify="required" lay-search="">
                        <option value="1" th:selected="${cust.csource eq 1}">直接选择或搜索选择</option>
                        <option value="2" th:selected="${cust.csource eq 2}">老客户</option>
                        <option value="3" th:selected="${cust.csource eq 3}">代理商</option>
                        <option value="4" th:selected="${cust.csource eq 4}">互联网</option>
                        <option value="5" th:selected="${cust.csource eq 5}">独立开发</option>
                        <option value="6" th:selected="${cust.csource eq 6}">客户介绍</option>
                        <option value="7" th:selected="${cust.csource eq 7}">合作伙伴</option>
                        <option value="8" th:selected="${cust.csource eq 8}">促销活动</option>
                        <option value="9" th:selected="${cust.csource eq 9}">媒体宣传</option>
                        <option value="10" th:selected="${cust.csource eq 10}">电话访问</option>
                        <option value="11" th:selected="${cust.csource eq 11}">客户来电</option>
                        <option value="12" th:selected="${cust.csource eq 12}">二次销售</option>
                        <option value="13" th:selected="${cust.csource eq 13}">公开招标</option>
                        <option value="14" th:selected="${cust.csource eq 14}">研讨会和展会</option>
                        <option value="15" th:selected="${cust.csource eq 15}">其他</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">预计成交金额:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bpredictMoney" lay-verify="required|bpredictMoney" autocomplete="off" class="layui-input"  th:value="${bus.bpredictMoney}">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">预计结单日期:</label>
                <div class="layui-input-inline">
                    <input type="text" name="boverDate" id="date" lay-verify="date" placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input"  th:value="${bus.boverDate}">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">联系人:</label>
                <div class="layui-input-inline">
                    <input type="text" name="blinkman" lay-verify="required|blinkman" autocomplete="off" class="layui-input"  th:value="${bus.blinkman}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">部门:</label>
                <div class="layui-input-block">
                    <input type="text" name="bdept" lay-verify="required|bdept" autocomplete="off" placeholder="请输入详细地址" class="layui-input"  th:value="${bus.bdept}">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">职务:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bjob" lay-verify="required|bjob" autocomplete="off" class="layui-input"  th:value="${bus.bjob}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">固定电话:</label>
                <div class="layui-input-block">
                    <input type="text" name="bofficeno" lay-verify="required|bofficeno" autocomplete="off" placeholder="请输入详细地址" class="layui-input"  th:value="${bus.bofficeno}">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">移动电话:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bphoneno" lay-verify="required|bphoneno" autocomplete="off" class="layui-input"  th:value="${bus.bphoneno}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">邮箱:</label>
                <div class="layui-input-block">
                    <input type="text" name="bemail" lay-verify="required|bemail" autocomplete="off" placeholder="请输入详细地址" class="layui-input"  th:value="${bus.bemail}">
                </div>
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">主要业务需求:</label>
            <div class="layui-input-block">
                <textarea placeholder="请输入内容" class="layui-textarea" name="bneed"  th:value="${bus.bneed}"></textarea>
            </div>
        </div>
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
            <legend>指定允许上传的文件类型</legend>
        </fieldset>

        <button type="button" class="layui-btn" id="test3" name="bfile"><i class="layui-icon"></i>上传文件</button>
        <input type="hidden" name="bfile" id="hi"/>

        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机所属部门:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bofDept" lay-verify="required|bofDept" autocomplete="off" class="layui-input"  th:value="${bus.bofDept}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">商机负责人:</label>
                <div class="layui-input-block">
                    <input type="text" name="bprincipal" lay-verify="required|bprincipal" autocomplete="off" placeholder="请输入详细地址" class="layui-input"  th:value="${bus.bprincipal}">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">商机参与人:</label>
                <div class="layui-input-inline">
                    <input type="text" name="bjoinMan" lay-verify="required|bjoinMan" autocomplete="off" class="layui-input"  th:value="${bus.bjoinMan}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">商机关注人:</label>
                <div class="layui-input-block">
                    <input type="text" name="battention" lay-verify="required|battention" autocomplete="off" placeholder="请输入详细地址" class="layui-input"  th:value="${bus.battention}">
                </div>
            </div>
        </div>
        <div class="layui-form-item"  style="text-align: center">
            <div class="layui-form-item">
                <button class="layui-btn" lay-submit lay-filter="demo2">立即提交</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>

    </form>
</div>

<script>
    layui.use(['form','layer', 'laydate','upload'], function(){
        var form = layui.form,layer= layui.layer,upload=layui.upload  ,laydate = layui.laydate , $ = layui.$;

        $("#but").click(function(){
            window.parent.location.reload();
        });


        form.on('submit(demo2)', function(data){
            var da=data.field;
            $.ajax({
                type:'post',
                url:'/crmsystem/bussinessOppo/update.do',
                data:da,
                success:function (data) {
                    if(data == 0){
                        var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
                        setTimeout(function () {
                            parent.layer.close(index);
                        },1100);

                        layer.msg("修改成功，1秒关闭",{
                            icon:1,
                            time:1000
                        },function() {
                            //do...
                            parent.location.reload();
                        });
                        window.location.href="/crmsystem/projectPage/bussinessOppo/myBussinessOppo.html"
                    }
                }
            });
           /* return true; *///阻止表单跳转。如果需要表单跳转，去掉这段即可。
        });

        //指定允许上传的文件类型
        upload.render({
            elem: '#test3'
            ,url: 'afterSell/uploadFile.do' //改成您自己的上传接口
            ,accept: 'file' //普通文件
            ,done: function(res){
                $("#hi").val(res.filename);
                layer.msg('上传成功');
                console.log(res);
            }
        });
        laydate.render({
            elem: '#date'
        });
    });
</script>













</body>
</html>